<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://java.sun.com/jsf/html" xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets" xmlns:p="http://primefaces.org/ui"
	xmlns:sec="http://www.springframework.org/security/tags">

<ui:composition template="/templates/template.xhtml">

	<ui:define name="content">
		
		<p:toolbar>
			<f:facet name="left">
				<h:panelGrid columns="4">
					<p:spacer width="10px"/>
					<p:graphicImage value="/img/projetos64.png"/>
					<p:spacer width="10px"/>
					<p:outputLabel value="Projetos" />
				</h:panelGrid>
			</f:facet>
		</p:toolbar>
			
		<p:panel id="listagemProjetos">
			
			<p:commandButton value="Adicionar Projeto" icon="ui-icon-plus" resetValues="true"
					actionListener="#{projetoBean.novoProjeto}" id="btnAdicionarProjeto" onclick="PF('load').show()"/>
			
			<p:spacer height="30px"/>
					
			<p:dataTable var="projeto" value="#{projetoBean.lazyProjeto}" paginator="true" rows="10" rowKey="#{projeto.id}"
				paginatorTemplate="{RowsPerPageDropdown} {FirstPageLink} {PreviousPageLink} {CurrentPageReport} {NextPageLink} {LastPageLink}"
				rowsPerPageTemplate="5,10,15" selectionMode="single" id="dtProjeto" lazy="true"
				paginatorPosition="bottom" widgetVar="projetoTable">

				<p:ajax event="rowSelect" listener="#{projetoBean.onRowSelect}" onstart="PF('load').show()"  global="false" 
				oncomplete="PF('load').hide()" process="@this" />

				<p:column headerText="Nome" sortBy="#{projeto.nome}" filterBy="#{projeto.nome}">
					<h:outputText value="#{projeto.nome}" />
				</p:column>
				<p:column headerText="Data Inicial" >
					<h:outputText value="#{calendarToString.obterData(projeto.dataInicial)}" />
				</p:column>
				<p:column headerText="Data Final">
					<h:outputText value="#{calendarToString.obterData(projeto.dataFinalPrevista)}" />
				</p:column>
			</p:dataTable>
			
			<p:blockUI block="dtProjeto" trigger="dtProjeto">
				<p:graphicImage value="/img/loading.gif"/>
		    </p:blockUI>
		</p:panel>

	</ui:define>

</ui:composition>

</html>